;===============================================================================;
;GetRandomFileName
;Описание: Функция возвращает указатель на строку с именем файла
;Вход:
;	Delta - дельта смещение
;===============================================================================;
GetRandomFileName proc Delta:DWORD
	startproc
	mov ebx,Delta
;Получаем случайное число
	apiproc _GetTickCount
	mov ecx,eax
;Масштабируем его на количество имен файлов
	mov edx,0
	mov ecx,38
	div ecx;eax/38
	mov edi,edx
;Получаем адрес строки в списке
	lea esi,[ebx+FileList]
NextFileName:
	push esi
	apiproc _lstrlenA
	.if edi!=0
		add esi,eax
		inc esi
		dec edi
		jmp NextFileName
	.endif
	mov eax,esi
	endproc
	ret
GetRandomFileName endp
;===============================================================================;